
{% extends "base_generic.html" %}

{% block content %}



<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title></title>
<link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
<link rel="stylesheet" href="/resources/demos/style.css">
<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>



<!-- Latest compiled and minified CSS -->
<!--
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
-->
<!-- Optional theme -->
<!--
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">
-->
<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<!--
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
-->
<!-- Latest compiled and minified JavaScript -->
<!--
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
-->



<script src='https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js'> </script>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->

<style>

table {
  border-collapse: collapse;
}

table tr {
  border-bottom: 1px solid black;
}
/*
table tr:last-child {
  border: 0;
}
*/
td {
  border-right: solid 1px;
  border-left: solid 1px;
}

.chart-container {
  position: relative;
  margin: auto;
  height: 35vh;
  width: 35vw;
}


</style>


<script>
$( function() {
$.datepicker.regional['tr'] = {
  monthNames: ['Ocak','Şubat','Mart','Nisan','Mayıs','Haziran',
  'Temmuz','Ağustos','Eylül','Ekim','Kasım','Aralık'],
  monthNamesShort: ['Oca','Şub','Mar','Nis','May','Haz',
  'Tem','Ağu','Eyl','Eki','Kas','Ara'],
  weekHeader: 'Hf', weekStatus: '',
  dayNames: ['Pazar','Pazartesi','Salı','Çarşamba','Perşembe','Cuma','Cumartesi'],
  dayNamesShort: ['Paz','Pzt','Sal','Çar','Per','Cum','Cmt'],
  dayNamesMin: ['Pa','Pt','Sa','Ça','Pe','Cu','Ct'],
  dateFormat: 'yy-mm-dd', firstDay: 1,
  prevText: 'Önce',
  nextText: 'Sonra',
  isRTL: false};
$.datepicker.setDefaults($.datepicker.regional['tr']);
$( "#datepicker" ).datepicker()
} );
</script>






<script>
function sakla(){
var x = document.getElementById("div_proje");
var y = document.getElementById("div_canvas");
var z = document.getElementById("div_table");
x.style.display = "none";
y.style.display = "none";
z.style.display = "none";
}
</script>


<script>
function dataChart(){
  //alert("buraya da geldi......!!!!!");
  var endpoint = '/charts/api/data/';
  var defaultData = [];
  var labels = [];
  $.ajax({
      method: "GET",
      url: endpoint,
      success: function(data){
          //alert(data)
          labels_1 = data.labels_1;
          defaultData_1 = data.default_1;
          labels_2 = data.labels_2;
          defaultData_2 = data.default_2;
          $("#div_proje").text("Proje: "+ data.proje);
          $("#m1").text(data.mem_1);
          $("#m2").text(data.mem_2);
          $("#m3").text(data.mem_3);
          $("#mt").text(data.mem_toplam);
          $("#my1").text("%"+data.m_yuzde_1);
          $("#my2").text("%"+data.m_yuzde_2);
          $("#my3").text("%"+data.m_yuzde_3);
          $("#s1").text(data.seb_1);
          $("#s2").text(data.seb_2);
          $("#s3").text(data.seb_3);
          $("#s4").text(data.seb_4);
          $("#s5").text(data.seb_5);
          $("#s6").text(data.seb_6);
          $("#st").text(data.seb_toplam);
          $("#sy1").text("%"+data.s_yuzde_1);
          $("#sy2").text("%"+data.s_yuzde_2);
          $("#sy3").text("%"+data.s_yuzde_3);
          $("#sy4").text("%"+data.s_yuzde_4);
          $("#sy5").text("%"+data.s_yuzde_5);
          $("#sy6").text("%"+data.s_yuzde_6);
          setChart(labels_1, defaultData_1, labels_2, defaultData_2);
      },
      error: function(error_data){
          console.log("error");
          console.log(error_data);
      }
  })
}
</script>

<script>
function setChart(labels_1, defaultData_1, labels_2, defaultData_2){
    //alert("buraya buraya da geldi.........................");
    var ctx = document.getElementById("myChart");
    //ctx.textAlign = "center";
    var ctx2 = document.getElementById("myChart2");
    ctx2.textAlign = "center";
    var myChart = new Chart(ctx2, {
          type: 'bar',
          data: {
              labels: labels_2,
              datasets: [{
                  label: 'Memnuniyetsizlik Sebepleri',
                  data: defaultData_2,
                  backgroundColor: [
                      'rgba(54, 162, 235, 0.8)',
                      'rgba(255, 206, 86, 0.8)',
                      'rgba(75, 192, 192, 0.8)',
                      'rgba(153, 102, 255, 0.8)',
                      'rgba(255, 159, 64, 0.8)',
                      'rgba(255, 99, 132, 0.8)'
                  ],
                  borderColor: [
                      'rgba(54, 162, 235, 1)',
                      'rgba(255, 206, 86, 1)',
                      'rgba(75, 192, 192, 1)',
                      'rgba(153, 102, 255, 1)',
                      'rgba(255, 159, 64, 1)',
                      'rgba(255,99,132,1)'
                  ],
                  borderWidth: 1
              }]
          },
          options: {
              maintainAspectRatio: false,
              /*
              layout: {
                   padding: {
                       left: 50,
                       right: 0,
                       top: 0,
                       bottom: 0
                   }
              }
              */
              scales: {
                  yAxes: [{
                      ticks: {
                          beginAtZero:true
                          //min: 30
                      }
                  }]
              }
          }
        });  //  end  new chart.....chart 1 ....

          var myChart = new Chart(ctx, {
          //type: 'polarArea',
          type: 'doughnut',
          data: {
              labels: labels_1,
              datasets: [{
                  label: 'Memnuniyet',
                  data: defaultData_1,
                  backgroundColor: [
                      'rgba(0, 255, 0, 0.6)',
                      'rgba(255, 255, 0, 0.6)',
                      'rgba(255, 0, 0, 0.6)'
                  ],
                  borderColor: [
                      'rgba(54, 162, 235, 1)',
                      'rgba(255, 206, 86, 1)',
                      'rgba(255, 159, 64, 1)'
                  ],
                  borderWidth: 1
              }]
          },

          options: {
            segmentShowStroke : true,
        		segmentStrokeColor : "#fff",
        		segmentStrokeWidth : 2,
        		percentageInnerCutout : 50,
        		animationSteps : 100,
        		animationEasing : "easeOutBounce",
        		animateRotate : true,
        		animateScale : false,
        		responsive: true,
        		maintainAspectRatio: false,
        		showScale: true,
        		animateScale: true
          }

      });   // end   second chart............

}  // end ************  function  set chart  ****************
// var ctx = document.getElementById("myChart");
</script>


<script>
$(document).ready(function(){
  //alert("buraya geldi....");
  //dataChart();
  sakla()
})
</script>

<h2>Memnuniyet Değerlendirme </h2>

<form method="post" onsubmit="goster()" >
      {% csrf_token %}
      {{ form.errors }}
      {{ form.non_field_errors }}
      {{ form.proje.label_tag }}
        {{ form.proje.errors }}
        {{ form.proje }}
      {{ form.hedef_baslangic.label_tag }}
        {{ form.hedef_baslangic.errors }}
        {{ form.hedef_baslangic }}
      {{ form.hedef_bitis.label_tag }}
        {{ form.hedef_bitis.errors }}
        {{ form.hedef_bitis }}
      <button type="submit">Göster</button>
</form>




<h3 id="div_proje"> </h3>

<div class='row' id="div_canvas" >
    <div class='col-sm-12' url-endpoint='{% url "api-data" %}' >

        <div class='col-sm-6 chart-container' >
            <canvas id="myChart"></canvas>
        </div>

        <div class='col-sm-6 chart-container' >
            <canvas id="myChart2"></canvas>
        </div>
    </div>
</div>


<div class='row' id="div_table">
    <div class='col-sm-12' url-endpoint='{% url "api-data" %}' >

        <div class='col-sm-6'>

          <table >
                  <tr>
                    <th></th>
                    <th>Çok Memnun  &emsp;  &emsp; </th>
                    <th>Memnun   &emsp; &emsp;  </th>
                    <th>Memnun Değil   &emsp;  &emsp; </th>
                    <th>Toplam  &emsp; &emsp;  </th>
                  </tr>


                  <tr>
                    <td align="center"> &emsp;Adet&emsp; </td>
                    <td id="m1" align="center">... </td>
                    <td id="m2" align="center">... </td>
                    <td id="m3" align="center">...  </td>
                    <td id="mt" align="center">...  </td>
                  </tr>


                  <tr>
                    <td align="center">&emsp; Yüzde &emsp; </td>
                    <td id="my1" align="center">... </td>
                    <td id="my2" align="center">... </td>
                    <td id="my3" align="center">...  </td>
                    <td align="center"> - </td>
                  </tr>

          </table>

        </div>

        <div class='col-sm-6'>

          <table>
                  <tr>
                    <th></th>
                    <th>Sabunluk &emsp; </th>
                    <th>Lavabo &emsp;   </th>
                    <th>Havlu &emsp;   </th>
                    <th>Koku &emsp;  </th>
                    <th>Tuvalet &emsp;  </th>
                    <th>T.Kağıdı &emsp;  </th>
                    <th>Toplam &emsp;   </th>
                  </tr>

                  <tr>
                    <td align="center">&emsp; Adet &emsp;</td>
                    <td id="s1" align="center">... </td>
                    <td id="s2" align="center">... </td>
                    <td id="s3" align="center">...  </td>
                    <td id="s4" align="center">... </td>
                    <td id="s5" align="center">... </td>
                    <td id="s6" align="center">...  </td>
                    <td id="st" align="center">...  </td>
                  </tr>


                  <tr>
                    <td align="center"> &emsp;Yüzde &emsp;</td>
                    <td id="sy1" align="center">... </td>
                    <td id="sy2" align="center">... </td>
                    <td id="sy3" align="center">...  </td>
                    <td id="sy4" align="center">... </td>
                    <td id="sy5" align="center">... </td>
                    <td id="sy6" align="center">...  </td>
                    <td align="center"> - </td>
                  </tr>

          </table>

        </div>
    </div>
</div>






{% endblock %}
